import{_,b as g,u as f,a as p,e as r,k as u,v as c,n,t as h,h as v,o as m,p as E,m as I}from"./index-RvlfNf1O.js";var b={VITE_APP_API_URL:"https://vue3-course-api.hexschool.io",VITE_APP_API_NAME:"paul7426",BASE_URL:"/Vue-2023-Week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:x}=b,M={data(){return{onLoading:!1,isEmptyInvalid:!1,errMsg:"",user:{email:"",password:""}}},methods:{clearErrMsg(){this.isEmptyInvalid=!1,this.errMsg!==""&&(this.errMsg="")},async login(){const{email:o,password:e}=this.user;if(o===""||e===""){this.isEmptyInvalid=!0,this.errMsg="請輸入信箱或密碼！";return}try{this.onLoading=!0;const a=await g.post(`${x}/v2/admin/signin`,{username:o,password:e});if(a.data.success){const{token:l,expired:s}=a.data;this.onLoading=!1,f.set("hexW6Token",l,{expires:s}),localStorage.setItem("isLogin",!0),this.$router.push("/admin")}}catch(a){this.onLoading=!1;const{status:l}=a.response;l===400&&(this.errMsg="信箱或密碼有誤！")}}}},d=o=>(E("data-v-a405bb95"),o=o(),I(),o),w={class:"wrap"},y=d(()=>r("h1",{class:"login__title h1 fw-bold mb-4 text-center"},"請先登入",-1)),P={id:"loginForm",action:"post",class:"p-4 mx-auto"},L={class:"form-floating mb-3"},V=d(()=>r("label",{for:"userEmail"},"Email address",-1)),k={class:"form-floating mb-4"},A=d(()=>r("label",{for:"userPassword"},"Password",-1)),S={class:"text-center mb-4"},D={key:0,class:"text-danger fs-5 text-center"};function R(o,e,a,l,s,i){return m(),p("div",w,[y,r("form",P,[r("div",L,[u(r("input",{type:"email",class:n(["form-control",{"is-invalid":s.isEmptyInvalid&&s.user.email===""}]),id:"userEmail",placeholder:"請輸入帳號","onUpdate:modelValue":e[0]||(e[0]=t=>s.user.email=t),onInput:e[1]||(e[1]=(...t)=>i.clearErrMsg&&i.clearErrMsg(...t))},null,34),[[c,s.user.email]]),V]),r("div",k,[u(r("input",{type:"password",class:n(["form-control",{"is-invalid":s.isEmptyInvalid&&s.user.password===""}]),id:"userPassword",placeholder:"請輸入密碼","onUpdate:modelValue":e[2]||(e[2]=t=>s.user.password=t),onInput:e[3]||(e[3]=(...t)=>i.clearErrMsg&&i.clearErrMsg(...t))},null,34),[[c,s.user.password]]),A]),r("div",S,[r("button",{type:"button",class:"btn btn-primary col-8 px-3",onClick:e[4]||(e[4]=(...t)=>i.login&&i.login(...t))}," 登入 ")]),r("div",null,[r("div",{class:n(["mx-auto",{loader:s.onLoading&&s.errMsg===""}])},[s.errMsg?(m(),p("p",D,h(s.errMsg),1)):v("",!0)],2)])])])}const U=_(M,[["render",R],["__scopeId","data-v-a405bb95"]]);export{U as default};
